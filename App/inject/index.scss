$prefix: 'bx-dev';
$carbonPrefix: 'bx';

@import '@carbon/type/scss/type';
@import '~@carbon/type/scss/styles';
@import '@carbon/type/scss/font-face/mono';

@include carbon--type-reset();
@include carbon--font-face-mono();

@import '~@carbon/grid/scss/prefix';
@import "~@carbon/layout/scss/breakpoint";
@import "~@carbon/layout/scss/mini-unit";
@import "~@carbon/grid/scss/grid";
@import "~@carbon/colors/scss/colors";
@import "~@carbon/themes/scss/themes";
@import "~@carbon/motion/scss/motion";

$transition-in: .3s carbon--motion('entrance');
$transition-out: .15s carbon--motion('exit');

$grid-color: map-get(map-get($carbon--colors, 'blue'), 60);
$grid-opacity: .5;
$grid-border-size: 1px;
$grid-border-color: $grid-color;
$grid-border-opacity: 1;

$grid-inner-color:  $grid-color;
$grid-inner-opacity: $grid-opacity;
$grid-inner-border-size: $grid-border-size;
$grid-inner-border-color: $grid-border-color;
$grid-inner-border-opacity: $grid-border-opacity;

$grid-outer-color: $grid-color;
$grid-outer-opacity: $grid-inner-opacity / 2;
$grid-outer-border-size: $grid-border-size;
$grid-outer-border-color: $grid-border-color;
$grid-outer-border-opacity: $grid-border-opacity;

$grid-mini-unit-color: $grid-color;
$grid-mini-unit-opacity: $grid-color;
$grid-mini-unit-border-size: $grid-border-size;
$grid-mini-unit-border-color: $grid-border-color;
$grid-mini-unit-border-opacity: $grid-opacity;

body {
    position: relative;
    
    &::after {
        content: '';
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        height: auto;
        min-height: 100vh;
        width: auto;
        display: block;
        pointer-events: none;
        z-index: 999999999;

        background-attachment: scroll;

        background-size: carbon--mini-units(1) carbon--mini-units(1);
        background-image:
        linear-gradient(to right, rgba($grid-mini-unit-border-color, $grid-mini-unit-border-opacity) $grid-mini-unit-border-size, transparent $grid-mini-unit-border-size),
        linear-gradient(to bottom, rgba($grid-mini-unit-border-color, $grid-mini-unit-border-opacity) $grid-mini-unit-border-size, transparent $grid-mini-unit-border-size);

        opacity: 0;
    }

    .#{$prefix}--grid--fixed &::after {
        background-attachment: fixed;
    }

    .#{$prefix}--grid--mini-unit &::after {
        opacity: 1;
    }

    .#{$prefix}--grid--hide &,
    html:active &,
    &:active {
        &::after {
            opacity: 0;
        }
    }
}

.#{$prefix}--grid {
    &-container {
        position: absolute;
        z-index: 9999999999;
        height: auto;
        width: auto;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        
        pointer-events: none;
        opacity: 1;

        * {
          box-sizing: border-box;
        }

        .#{$prefix}--grid--hide &,
        html:active &,
        body:active & {
            opacity: 0;
        }
        
        .#{$prefix}--grid--breakpoint-label &::after {
            @include carbon--theme($carbon--theme--g90) {
                @include carbon--type-style('code-01');
                @include carbon--font-family('mono');

                position: fixed;
                background: $ui-background;
                padding: carbon--mini-units(1) ($carbon--grid-gutter / 2);
                color: $text-01;
                bottom: 0;
                right: 0;
                z-index: 9999999999;
                
                @include carbon--breakpoint('sm') {
                    content: 'Breakpoint: Small';
                }
                
                @include carbon--breakpoint('md') {
                    content: 'Breakpoint: Medium';
                }
                
                @include carbon--breakpoint('lg') {
                    content: 'Breakpoint: Large';
                }
                
                @include carbon--breakpoint('xlg') {
                    content: 'Breakpoint: X-Large';
                }
                
                @include carbon--breakpoint('max') {
                    content: 'Breakpoint: Max';
                }
            }
        }

        [class*="#{$prefix}--col-"]::before {
            display: block;
            content: ''
        }

        &.#{$prefix}--grid--inner {
            [class*="#{$prefix}--col-"] {
                &::before {
                    background-color: rgba($grid-inner-color, $grid-inner-opacity);
                }
            }
        }

        &.#{$prefix}--grid--outer {
            [class*="#{$prefix}--col-"] {
                &::before {
                    box-shadow:
                        $carbon--grid-gutter/2 0 0 rgba($grid-outer-color, $grid-outer-opacity),
                        ($carbon--grid-gutter/2 * -1) 0 0 rgba($grid-outer-color, $grid-outer-opacity);
                }
            }
        }

        &.#{$prefix}--grid--inner-border {
            [class*="#{$prefix}--col-"] {
                &::before {
                    box-shadow:
                        $grid-inner-border-size 0 0 rgba($grid-inner-border-color, $grid-inner-border-opacity),
                        ($grid-inner-border-size * -1) 0 0 rgba($grid-inner-border-color, $grid-inner-border-opacity);
                }
            }
        }

        &.#{$prefix}--grid--outer.#{$prefix}--grid--inner-border {
            [class*="#{$prefix}--col-"] {
                &::before {
                    box-shadow:
                        $carbon--grid-gutter/2 0 0 rgba($grid-outer-color, $grid-outer-opacity),
                        ($carbon--grid-gutter/2 * -1) 0 0 rgba($grid-outer-color, $grid-outer-opacity),
                        $grid-inner-border-size 0 0 rgba($grid-inner-border-color, $grid-inner-border-opacity),
                        ($grid-inner-border-size * -1) 0 0 rgba($grid-inner-border-color, $grid-inner-border-opacity);
                }
            }
        }

        &.#{$prefix}--grid--outer-border {
            [class*="#{$prefix}--col-"] {
                box-shadow: $grid-outer-border-size 0 0 rgba($grid-outer-border-color, $grid-outer-border-opacity);
                
                &:first-child {
                    box-shadow: $grid-outer-border-size 0 0 rgba($grid-outer-border-color, $grid-outer-border-opacity),
                    ($grid-outer-border-size * -1) 0 0 rgba($grid-outer-border-color, $grid-outer-border-opacity);
                }
            }
        }
    }

    &-overlay {
        width: 100%;
        position: fixed;
        left: 0;
        top: 0;
        z-index: 9999999999;
        
        &,
        .#{$prefix}--grid,
        .#{$prefix}--row,
        [class*="#{$prefix}--col-"],
        [class*="#{$prefix}--col-"]::before {
            height: 100vh;
        }
    }
}

.#{$carbonPrefix}--grid {
    $gutter-overlay-left: $carbon--grid-gutter/2 0 0 rgba($grid-outer-color, $grid-outer-opacity);
    $gutter-overlay-right: ($carbon--grid-gutter/2 * -1) 0 0 rgba($grid-outer-color, $grid-outer-opacity);

    [class*="#{$carbonPrefix}--col"] {
        position: relative;
        z-index: 99;
        
        &::after {
            pointer-events: none;
            opacity: 0;
            z-index: 99;
            position: absolute;
            left: 0;
            top: 0;

            @include carbon--theme($carbon--theme--g100) {
                @include carbon--type-style('code-01');
                @include carbon--font-family('mono');

                background: rgba($grid-inner-border-color, 1);
                color: $text-01;
                padding: carbon--mini-units(1) ($carbon--grid-gutter / 2);
            }
        }

        .#{$prefix}--grid--hover &:hover {
            &::after {
                opacity: 1;
                z-index: 999;
            }

            &:hover {
                z-index: 999;
            }
        }

        .#{$prefix}--grid--hide &:hover {
            &::after {
                opacity: 0;
                z-index: 99;
            }

            &:hover {
                z-index: 99;
            }
        }
    }

    .#{$prefix}--grid--hover & {
        [class*="bx--col"]:hover {
            box-shadow: 0 0 0 $grid-inner-border-size rgba($grid-inner-border-color, $grid-inner-border-opacity);
        }
    }

    .#{$prefix}--grid--hide & {
        [class*="bx--col"]:hover {
            box-shadow: none;
        }
    }

    .#{$carbonPrefix}--col {
        
        &::after { content: '.#{$carbonPrefix}--col'; }
        
        @each $size, $breakpoint in $carbon--grid-breakpoints {
            @include carbon--breakpoint($size) {
                &-#{$size} {
                    @for $i from 1 through map-get($breakpoint, 'columns') {
                        &-#{$i}::after { content: '.#{$carbonPrefix}--col-#{$size}-#{$i}'; }
                    }
                }
            }
        }
    }
}